<!DOCTYPE html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
--><html lang="en" class="no-js">
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <!-- overrides: https://github.com/mmistakes/minimal-mistakes/blob/master/_includes/head.html -->

<meta charset="utf-8">

<!-- begin _includes/seo.html --><title>ModelBatch - libGDX</title>
<meta name="description" content="libGDX is a cross-platform Java game development framework based on OpenGL (ES) that works on Windows, Linux, macOS, Android, your browser and iOS.">



<meta property="og:type" content="website">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="libGDX">
<meta property="og:title" content="ModelBatch">
<meta property="og:url" content="https://crykn.github.io/pages/crykn/wiki/modelbatch">


  <meta property="og:description" content="libGDX is a cross-platform Java game development framework based on OpenGL (ES) that works on Windows, Linux, macOS, Android, your browser and iOS.">



  <meta property="og:image" content="https://crykn.github.io/pages/crykn/assets/images/logo.png">










<link rel="canonical" href="https://crykn.github.io/pages/crykn/wiki/modelbatch">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": null,
      "url": "https://crykn.github.io/pages/crykn/"
    
  }
</script>


  <meta name="google-site-verification" content="qc0iys9Aweas1z8EhICO-0Ohwh6Iq1GDV6K75e0ToO8">






<!-- end _includes/seo.html -->



  <link href="/pages/crykn/feed.xml" type="application/atom+xml" rel="alternate" title="libGDX Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- Light mode -->
<link rel="stylesheet" href="/pages/crykn/assets/css/main.css">

<!-- Dark mode -->

  <meta name="color-scheme" content="light dark">
  <style>
    @import url("/pages/crykn/assets/css/main2.css") (prefers-color-scheme: dark);
  </style>


<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>




    <!-- Favicons -->
<link rel="apple-touch-icon" sizes="180x180" href="/assets/icons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/icons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/icons/favicon-16x16.png">
<link rel="manifest" href="/assets/icons/site.webmanifest">
<link rel="mask-icon" href="/assets/icons/safari-pinned-tab.svg" color="#5bbad5">
<link rel="shortcut icon" href="/assets/icons/favicon.ico">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/icons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">

    <link rel="stylesheet" href="/assets/css/wiki.css">
  </head>

  <body class="layout--wiki">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    <!-- overrides: _includes/masthead.html -->




<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/pages/crykn/">
            <picture>
              
                <!-- dark mode logo -->
                <source srcset="/pages/crykn/assets/brand/logo_dark.svg" media="(prefers-color-scheme: dark)">
              
              <img src="/pages/crykn/assets/brand/logo.svg" alt=" ">
            </source></picture>
          </a>
        
        <a class="site-title" href="/pages/crykn/">
           
          
        </a>
        <ul class="visible-links">
<li class="masthead__menu-item">
              <a href="/pages/crykn/">Back to Main Site</a>
            </li>
<li class="masthead__menu-item">
              <a href="/pages/crykn/wiki/">Wiki Home</a>
            </li>
</ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">

      <div id="main" role="main">
  <header>
    <h1 id="page-title" class="page__title" itemprop="headline">ModelBatch
</h1>

    <div class="header-meta">
      Last edited on 17 November 2021 • <a href="https://github.com/crykn/crykn.github.io/commits/dev/" rel="external">View revision history<span class="ico-ext"><i class="fas fa-external-link-alt"></i></span></a> • <a href="https://github.com/crykn/crykn.github.io/edit/dev/_wiki/modelbatch.md" rel="external">Edit on GitHub<span class="ico-ext"><i class="fas fa-external-link-alt"></i></span></a>
    </div>
  </header>
  <article class="page h-entry" itemscope itemtype="https://schema.org/CreativeWork">
    <div class="page__inner-wrap">
      <section class="page__content e-content markdown-body" itemprop="text">
          <aside class="sidebar__right">
            <nav class="toc">
              <div class="toc__menu">
                
                <h1 id="table-of-contents">Table of Contents</h1>
<p><a href="/wiki/wiki-style-guide">Wiki Style Guide</a></p>

<h2 id="getting-started">Getting Started</h2>
<ul>
  <li><a href="/wiki/setup">Setting Up a Dev Environment</a></li>
  <li><a href="/wiki/project-generation">Creating Your First libGDX Project</a></li>
  <li><a href="/wiki/import-and-running">Importing &amp; Running It</a></li>
  <li><a href="/wiki/a-simple-game">A Simple Game</a></li>
  <li><a href="/wiki/simple-game-extended">Extending the Simple Game</a></li>
</ul>

<h2 id="developers-guide">Developer’s Guide</h2>
<details><summary>The Application Framework</summary>

<div>
    <ul>
      <li><a href="/wiki/the-application-framework">The Application Framework</a></li>
      <li><a href="/wiki/the-life-cycle">The Life-Cycle</a></li>
      <li><a href="/wiki/modules-overview">Modules Overview</a></li>
      <li><a href="/wiki/starter-classes-and-configuration">Starter Classes and Configuration</a></li>
      <li><a href="/wiki/querying">Querying</a></li>
      <li><a href="/wiki/logging">Logging</a></li>
      <li><a href="/wiki/threading">Threading</a></li>
      <li><a href="/wiki/interfacing-with-platform-specific-code">Interfacing With Platform-Specific Code</a></li>
    </ul>
  </div>

</details>

<p><a href="/wiki/file-handling">File Handling</a></p>

<p><a href="/wiki/networking">Networking</a></p>

<p><a href="/wiki/preferences">Preferences</a></p>

<details><summary>Input Handling</summary>

<div>
    <ul>
      <li><a href="/wiki/input-handling">Input Handling</a></li>
      <li><a href="/wiki/configuration-and-querying">Configuration and Querying</a></li>
      <li>
<a href="/wiki/mouse,-touch-and-keyboard">Mouse, Touch and Keyboard</a>
        <ul>
          <li><a href="/wiki/polling">Polling</a></li>
          <li><a href="/wiki/event-handling">Event Handling</a></li>
        </ul>
      </li>
      <li><a href="/wiki/controllers">Controllers</a></li>
      <li><a href="/wiki/gesture-detection">Gesture Detection</a></li>
      <li><a href="/wiki/simple-text-input">Simple Text Input</a></li>
      <li><a href="/wiki/accelerometer">Accelerometer</a></li>
      <li><a href="/wiki/compass">Compass</a></li>
      <li><a href="/wiki/gyroscope">Gyroscope</a></li>
      <li><a href="/wiki/vibrator">Vibrator</a></li>
      <li><a href="/wiki/cursor-visibility-and-catching">Cursor Visibility and Catching</a></li>
      <li><a href="/wiki/back-and-menu-key-catching">Back and Menu Key Catching</a></li>
      <li><a href="/wiki/on-screen-keyboard">On-Screen Keyboard</a></li>
      <li><a href="/wiki/adding-new-keycodes">Adding new Keycodes</a></li>
    </ul>
  </div>

</details>

<p><a href="/wiki/memory-management">Memory Management</a></p>

<details><summary>Audio</summary>

<div>
    <ul>
      <li><a href="/wiki/audio">Audio</a></li>
      <li><a href="/wiki/sound-effects">Sound Effects</a></li>
      <li><a href="/wiki/streaming-music">Streaming Music</a></li>
      <li><a href="/wiki/playing-pcm-audio">Playing PCM Audio</a></li>
      <li><a href="/wiki/recording-pcm-audio">Recording PCM Audio</a></li>
    </ul>
  </div>

</details>

<details><summary>Graphics</summary>

<div>
    <ul>
      <li><a href="/wiki/graphics">Graphics</a></li>
      <li><a href="/wiki/querying-and-configuring-graphics-(monitors,-display-modes,-vsync,-display-cutouts)">Querying and configuring graphics (monitors, display modes, vsync, display cutouts)</a></li>
      <li><a href="/wiki/continuous-and-non-continuous-rendering">Continuous and Non-Continuous Rendering</a></li>
      <li><a href="/wiki/clearing-the-screen">Clearing the Screen</a></li>
      <li><a href="/wiki/taking-a-screenshot">Taking a Screenshot</a></li>
      <li><a href="/wiki/profiling">Profiling</a></li>
      <li><a href="/wiki/viewports">Viewports</a></li>
      <li>
<a href="/wiki/opengl-(es)-support">OpenGL (ES) Support</a>
        <ul>
          <li>Configuration and Querying OpenGL ??</li>
          <li>Direct Access ??</li>
          <li>Utility Classes<br>
 -<a href="/wiki/rendering-shapes">Rendering Shapes</a><br>
 -<a href="/wiki/textures-and-textureregions">Textures and TextureRegions</a><br>
 -<a href="/wiki/meshes">Meshes</a><br>
 -<a href="/wiki/shaders">Shaders</a><br>
 -<a href="/wiki/frame-buffer-objects">Frame Buffer Objects</a>
</li>
        </ul>
      </li>
    </ul>

    <p>    <strong>2D Graphics</strong></p>
    <ul>
      <li><a href="/wiki/spritebatch,-textureregions,-and-sprites">SpriteBatch, TextureRegions, and Sprites</a></li>
      <li><a href="/wiki/2d-animation">2D Animation</a></li>
      <li><a href="/wiki/clipping,-with-the-use-of-scissorstack">Clipping, With the Use of ScissorStack</a></li>
      <li><a href="/wiki/masking">Masking</a></li>
      <li><a href="/wiki/orthographic-camera">Orthographic Camera</a></li>
      <li>Mapping Touch Coordinates ??</li>
      <li><a href="/wiki/ninepatches">NinePatches</a></li>
      <li>
<a href="/wiki/bitmap-fonts">Bitmap Fonts</a>
        <ul>
          <li><a href="/wiki/distance-field-fonts">Distance Field Fonts</a></li>
          <li><a href="/wiki/color-markup-language">Color Markup Language</a></li>
        </ul>
      </li>
      <li><a href="/wiki/using-textureatlases">Using TextureAtlases</a></li>
      <li><a href="/wiki/pixmaps">Pixmaps</a></li>
      <li><a href="/wiki/packing-atlases-offline">Packing Atlases Offline</a></li>
      <li><a href="/wiki/packing-atlases-at-runtime">Packing Atlases at Runtime</a></li>
      <li><a href="/wiki/texture-compression">Texture Compression</a></li>
      <li><a href="/wiki/2d-particleeffects">2D ParticleEffects</a></li>
      <li><a href="/wiki/tile-maps">Tile Maps</a></li>
      <li><a href="/wiki/scene2d">scene2d</a></li>
      <li>
<a href="/wiki/scene2d.ui">scene2d.ui</a>
        <ul>
          <li><a href="/wiki/table">Table</a></li>
          <li><a href="/wiki/skin">Skin</a></li>
        </ul>
      </li>
      <li><a href="/wiki/imgui">ImGui</a></li>
    </ul>

    <p>    <strong><a href="/wiki/3d-graphics">3D Graphics</a></strong></p>

    <ul>
      <li><a href="/wiki/quick-start">Quick Start</a></li>
      <li><a href="/wiki/models">Models</a></li>
      <li><a href="/wiki/material-and-environment">Material and Environment</a></li>
      <li><a href="/wiki/modelbatch">ModelBatch</a></li>
      <li><a href="/wiki/modelcache">ModelCache</a></li>
      <li><a href="/wiki/modelbuilder,-meshbuilder-and-meshpartbuilder">ModelBuilder, MeshBuilder and MeshPartBuilder</a></li>
      <li><a href="/wiki/3d-animations-and-skinning">3D Animations and Skinning</a></li>
      <li><a href="/wiki/importing-blender-models-in-libgdx">Importing Blender Models in libGDX</a></li>
      <li><a href="/wiki/3d-particle-effects">3D Particle Effects</a></li>
      <li><a href="/wiki/virtual-reality-(vr)">Virtual Reality (VR)</a></li>
      <li><a href="/wiki/3d-picking">3D Picking</a></li>
      <li>Perspective Camera ??</li>
    </ul>
  </div>

</details>

<p><a href="/wiki/managing-your-assets">Managing Your Assets</a></p>

<p><a href="/wiki/html5-backend-and-gwt-specifics">HTML5 Backend and GWT Specifics</a></p>

<p><a href="/wiki/internationalization-and-localization">Internationalization and Localization</a></p>

<details><summary>Utilities</summary>

<div>
    <ul>
      <li><a href="/wiki/reading-and-writing-json">Reading and Writing JSON</a></li>
      <li><a href="/wiki/reading-and-writing-xml">Reading and Writing XML</a></li>
      <li><a href="/wiki/collections">Collections</a></li>
      <li><a href="/wiki/reflection">Reflection</a></li>
      <li><a href="/wiki/jnigen">jnigen</a></li>
    </ul>
  </div>

</details>

<details><summary>Math Utilities</summary>

<div>
    <ul>
      <li><a href="/wiki/math-utilities">Math Utilities</a></li>
      <li><a href="/wiki/interpolation">Interpolation</a></li>
      <li><a href="/wiki/vectors,-matrices,-quaternions">Vectors, Matrices, Quaternions</a></li>
      <li><a href="/wiki/circles,-planes,-rays,-etc.">Circles, Planes, Rays, etc.</a></li>
      <li><a href="/wiki/path-interface-and-splines">Path Interface and Splines</a></li>
      <li>Bounding Volumes ??</li>
      <li>Intersection and Overlap Testing ??</li>
    </ul>
  </div>

</details>

<details><summary>Tools</summary>

<div>
    <ul>
      <li><a href="/wiki/texture-packer">Texture Packer</a></li>
      <li><a href="/wiki/hiero">Hiero</a></li>
      <li><a href="/wiki/2d-particle-editor">2D Particle Editor</a></li>
      <li><a href="/wiki/skin-composer">Skin Composer</a></li>
      <li><a href="/wiki/overlap2d">Overlap2D</a></li>
    </ul>
  </div>

</details>

<details><summary>Extensions</summary>

<div>
    <ul>
      <li><a href="/wiki/artificial-intelligence">Artificial Intelligence</a></li>
      <li><a href="/wiki/gdx-freetype">gdx-freetype</a></li>
      <li>
<a href="/wiki/gdx-pay">gdx-pay</a>: cross-platform In-App-Purchasing API</li>
      <li>
<a href="/wiki/physics">Physics</a>
        <ul>
          <li><a href="/wiki/box2d">Box2D</a></li>
          <li>
<a href="/wiki/bullet-physics">Bullet Physics</a><br>
 -<a href="/wiki/bullet-wrapper-setup">Setup</a><br>
 -<a href="/wiki/bullet-wrapper-using-the-wrapper">Using the Wrapper</a><br>
 -<a href="/wiki/bullet-wrapper-using-models">Using Models</a><br>
 -<a href="/wiki/bullet-wrapper-contact-callbacks">Contact Callbacks</a><br>
 -<a href="/wiki/bullet-wrapper-custom-classes">Custom Classes</a><br>
 -<a href="/wiki/bullet-wrapper-debugging">Debugging</a>
</li>
        </ul>
      </li>
      <li><a href="/wiki/third-party-extension-support">Publishing Your Own Extensions</a></li>
    </ul>
  </div>

</details>

<details><summary>Using libGDX With Other JVM Languages</summary>

<div>
    <ul>
      <li><a href="/wiki/using-libgdx-with-other-jvm-languages">Using libGDX With Other JVM Languages</a></li>
      <li><a href="/wiki/using-libgdx-with-clojure">Using libGDX With Clojure</a></li>
      <li><a href="/wiki/using-libgdx-with-kotlin">Using libGDX With Kotlin</a></li>
      <li><a href="/wiki/using-libgdx-with-python">Using libGDX With Python</a></li>
      <li><a href="/wiki/using-libgdx-with-scala">Using libGDX With Scala</a></li>
    </ul>
  </div>

</details>

<details><summary>Third Party Services</summary>

<div>
    <ul>
      <li><a href="/wiki/admob-in-libgdx">AdMob in libGDX</a></li>
      <li><a href="/wiki/airpush-in-libgdx">Airpush in libGDX</a></li>
      <li><a href="/wiki/firebase-in-libgdx">Firebase in libGDX</a></li>
      <li><a href="/wiki/smaato-in-libgdx">Smaato in libGDX</a></li>
      <li><a href="/wiki/google-play-games-services-in-libgdx">Google Play Games Services in libGDX</a></li>
      <li><a href="/wiki/pollfish-in-libgdx">Pollfish in libGDX</a></li>
      <li><a href="/wiki/proguard/dexguard-and-libgdx">ProGuard/DexGuard and libGDX</a></li>
    </ul>
  </div>

</details>

<h2 id="articles">Articles</h2>
<ul>
  <li><a href="/wiki/getting-help">Getting Help</a></li>
  <li><a href="/wiki/external-tutorials">External Tutorials</a></li>
  <li><a href="/wiki/java-development-kit---selection">Java Development Kit - Selection</a></li>
  <li><a href="/wiki/deploying-your-application">Deploying your application</a></li>
  <li><a href="/wiki/coordinate-systems">Coordinate systems</a></li>
  <li><a href="/wiki/updating-libgdx">Updating Your libGDX Version</a></li>
  <li><a href="/wiki/dependency-management-with-gradle">Adding Extensions and 3rd Party Libraries</a></li>
  <li><a href="/wiki/improving-workflow-with-gradle">Improving Your Gradle Workflow</a></li>
  <li><a href="/wiki/creating-a-separate-assets-project-in-eclipse">Creating Asset Project in Eclipse</a></li>
</ul>

              </div>
            </nav>
          </aside>

        <p><a href="http://libgdx.badlogicgames.com/nightlies/docs/api/com/badlogic/gdx/graphics/g3d/ModelBatch.html">ModelBatch</a> (<a href="https://github.com/libgdx/libgdx/blob/master/gdx/src/com/badlogic/gdx/graphics/g3d/ModelBatch.java" rel="external">code<span class="ico-ext"><i class="fas fa-external-link-alt"></i></span></a>) is a class used for managing render calls. It is typically used to render instances of <a href="https://github.com/libgdx/libgdx/wiki/Models" rel="external">models<span class="ico-ext"><i class="fas fa-external-link-alt"></i></span></a>, although it is not restricted to models. The ModelBatch class abstracts away all rendering code, providing a layer on top of it and allowing you to focus on more game specific logic. Every part of the ModelBatch functionality is customizable by design.</p>

<p><strong>Caution:</strong> because ModelBatch manages the render calls and therefore the rendering context, you should not try to manually modify the render context (e.g. bind shaders, texture or meshes, or call any function starting with <code class="language-plaintext highlighter-rouge">gl</code>) in between the <code class="language-plaintext highlighter-rouge">ModelBatch.begin()</code> and <code class="language-plaintext highlighter-rouge">ModelBatch.end()</code> calls. This will not work and might cause unpredictable behavior. Instead use the customization options that ModelBatch offers.</p>

<ul>
  <li><a href="#common-misconceptions">Common misconceptions</a></li>
  <li><a href="#overview">Overview</a></li>
  <li><a href="#using-modelbatch">Using ModelBatch</a></li>
  <li>
<a href="#gather-render-calls">Gather render calls</a>
    <ul>
      <li><a href="#what-are-render-calls">What are render calls?</a></li>
      <li><a href="#renderableprovider">RenderableProvider</a></li>
    </ul>
  </li>
  <li>
<a href="#gather-shaders">Gather Shaders</a>
    <ul>
      <li><a href="#what-is-a-shader">What is a shader?</a></li>
      <li><a href="#shaderprovider">ShaderProvider</a></li>
      <li><a href="#default-shader">Default shader</a></li>
    </ul>
  </li>
  <li><a href="#sorting-render-calls">Sorting render calls</a></li>
  <li>
<a href="#managing-the-render-context">Managing the render context</a>
    <ul>
      <li><a href="#rendercontext">RenderContext</a></li>
      <li>
<a href="#texturebinder">TextureBinder</a>
        <ul>
          <li><a href="#texturedescriptor">TextureDescriptor</a></li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h1 id="common-misconceptions">Common misconceptions</h1>
<ul>
  <li>ModelBatch is often compared to <a href="https://github.com/libgdx/libgdx/wiki/Spritebatch%2C-Textureregions%2C-and-Sprites" rel="external">SpriteBatch<span class="ico-ext"><i class="fas fa-external-link-alt"></i></span></a>. While this might be understandable from an API view, there are some very big differences making them less comparable. The main difference is that SpriteBatch merges multiple sprites into a single draw call, while ModelBatch doesn’t combine render calls. This does have performance implications, so be aware to merge any render calls before sending them to the ModelBatch.</li>
  <li>ModelBatch does not perform (frustum) culling. It simply hasn’t enough information to do this using the best performing method. By default, every call to <code class="language-plaintext highlighter-rouge">ModelBatch.render()</code> will at least lead to one actual render call. ModelBatch does allow you to customize this though and perform frustum culling prior to actually rendering. However, typically, you should perform (frustum) culling prior to calling <code class="language-plaintext highlighter-rouge">ModelBatch.render()</code>.</li>
</ul>

<h1 id="overview">Overview</h1>
<p>So what does ModelBatch actually do?</p>

<ol>
  <li>It gathers render calls</li>
  <li>It gathers a shader for each render call</li>
  <li>It sorts the render calls</li>
  <li>It manages the rendering context</li>
  <li>It executes the render calls</li>
</ol>

<p>That’s it. Nothing more, nothing less. And every part of this is customizable. Please be aware that because of this design, there might be multiple ways to accomplish the same basic task.</p>

<h1 id="using-modelbatch">Using ModelBatch</h1>
<p>ModelBatch is a relatively heavy weight object, because of the shaders it might create. When possible you should try to reuse it. You’d typically create a ModelBatch in the <code class="language-plaintext highlighter-rouge">create()</code> method. Because it contains native resources (like the shaders it uses), you’ll need to call the <code class="language-plaintext highlighter-rouge">dispose()</code> method when no longer needed.</p>

<p>Rendering should be done every frame, typically in your <code class="language-plaintext highlighter-rouge">render()</code> method. To start rendering you should call <code class="language-plaintext highlighter-rouge">modelBatch.begin(camera);</code>. Next use the <code class="language-plaintext highlighter-rouge">modelBatch.render(...);</code> method to add one or more render calls. When done adding render calls, you must call <code class="language-plaintext highlighter-rouge">modelBatch.end();</code> to actually render to specified calls.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nc">ModelBatch</span> <span class="n">modelBatch</span><span class="o">;</span>
    <span class="o">...</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">create</span> <span class="o">()</span> <span class="o">{</span>
        <span class="n">modelBatch</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ModelBatch</span><span class="o">();</span>
        <span class="o">...</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">render</span> <span class="o">()</span> <span class="o">{</span>
        <span class="o">...</span> <span class="c1">// call glClear etc.</span>
        <span class="n">modelBatch</span><span class="o">.</span><span class="na">begin</span><span class="o">(</span><span class="n">camera</span><span class="o">);</span>
        <span class="n">modelBatch</span><span class="o">.</span><span class="na">render</span><span class="o">(...);</span>
        <span class="o">...</span> <span class="c1">// add other render calls</span>
        <span class="n">modelBatch</span><span class="o">.</span><span class="na">end</span><span class="o">();</span>
        <span class="o">...</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">dispose</span> <span class="o">()</span> <span class="o">{</span>
        <span class="n">modelBatch</span><span class="o">.</span><span class="na">dispose</span><span class="o">();</span>
        <span class="o">...</span>
    <span class="o">}</span>
</code></pre></div></div>
<p>The call to <code class="language-plaintext highlighter-rouge">modelBatch.render(...)</code> is only valid in between the call to <code class="language-plaintext highlighter-rouge">modelBatch.begin(camera)</code> and <code class="language-plaintext highlighter-rouge">modelBatch.end()</code>. The actual rendering is performed at the call to <code class="language-plaintext highlighter-rouge">end();</code>. If you want to force rendering in between, then you can use the <code class="language-plaintext highlighter-rouge">modelBatch.flush();</code> method.</p>

<p>The <a href="http://libgdx.badlogicgames.com/nightlies/docs/api/com/badlogic/gdx/graphics/Camera.html"><code class="language-plaintext highlighter-rouge">Camera</code></a> you supply is hold by reference, meaning that it must not be changed in between the begin and end calls. If you need to switch camera in between the begin and end calls, then you can call the <code class="language-plaintext highlighter-rouge">modelBatch.setCamera(camera);</code>, which will <code class="language-plaintext highlighter-rouge">flush()</code> the batch if needed.</p>

<h1 id="gather-render-calls">Gather render calls</h1>
<h2 id="what-are-render-calls">What are render calls?</h2>
<p>The purpose of ModelBatch is to manage render calls. So what exactly is a render call and how do you specify them?</p>

<p>A “render call” (often also referred to as “draw call”) is basically the instruction to the GPU to render (display) something. Simply said, each “render call” displays a shape with some properties (e.g. a location, image, color, etc). Or to be more precise, it instructs the GPU to render a given part of a mesh using a given shader in a given context. We will look more in depth on this later.</p>

<blockquote>
  <p>For basic usage, you don’t have to know the exact details about a render call, because ModelBatch abstracts them away. However, there’s a performance impact of render calls. Typically each render call is executed on the GPU, meaning that it is executed in parallel to CPU code. Whenever a new render call is executed, it might imply that GPU and CPU need to be synchronized. Or in other words, having are few large render calls is typically better performing than having many smaller render calls.</p>
</blockquote>

<p>To specify a render call, libGDX contains the <a href="http://libgdx.badlogicgames.com/nightlies/docs/api/com/badlogic/gdx/graphics/g3d/Renderable.html">Renderable</a> (<a href="https://github.com/libgdx/libgdx/blob/master/gdx/src/com/badlogic/gdx/graphics/g3d/Renderable.java" rel="external">code<span class="ico-ext"><i class="fas fa-external-link-alt"></i></span></a>) class, which contains almost everything (except for the camera) required to perform a single render call. Basically it contains how (the shader) and where (the transformation) to render the shape (the mesh part) in which context (the environment and material).</p>

<p>The <code class="language-plaintext highlighter-rouge">render(...)</code> method of <code class="language-plaintext highlighter-rouge">ModelBatch</code> has many signatures (variations with different method arguments), one of which is <code class="language-plaintext highlighter-rouge">ModelBatch.render(Renderable);</code>. Using this method you can directly specify the render call you want to add to the ModelBatch. The other <code class="language-plaintext highlighter-rouge">render(...)</code> methods allow you to specify one or more render calls using a <code class="language-plaintext highlighter-rouge">RenderableProvider</code>. In those methods, the other arguments let you provide default values for those render calls. For example, when using the <code class="language-plaintext highlighter-rouge">ModelBatch#render(RenderableProvider, Environment, Shader)</code> method it will set (override) the <code class="language-plaintext highlighter-rouge">environment</code> and <code class="language-plaintext highlighter-rouge">shader</code> members of every <code class="language-plaintext highlighter-rouge">Renderable</code> the <code class="language-plaintext highlighter-rouge">RenderableProvider</code> provides.</p>

<h2 id="renderableprovider">RenderableProvider</h2>
<p><a href="http://libgdx.badlogicgames.com/nightlies/docs/api/com/badlogic/gdx/graphics/g3d/RenderableProvider.html"><code class="language-plaintext highlighter-rouge">RenderableProvider</code></a> (<a href="https://github.com/libgdx/libgdx/blob/master/gdx/src/com/badlogic/gdx/graphics/g3d/RenderableProvider.java" rel="external">code<span class="ico-ext"><i class="fas fa-external-link-alt"></i></span></a>) is an interface which you can implement to supply one or more <code class="language-plaintext highlighter-rouge">Renderable</code> instances. Probably the most common implementation of this interface is the <a href="http://libgdx.badlogicgames.com/nightlies/docs/api/com/badlogic/gdx/graphics/g3d/ModelInstance.html"><code class="language-plaintext highlighter-rouge">ModelInstance</code></a> class, which traverses all <a href="/wiki/models#nodes">nodes</a> (<a href="/wiki/models#nodepart">parts</a>) and translates them into a <code class="language-plaintext highlighter-rouge">Renderable</code> instance. However, you can use the <code class="language-plaintext highlighter-rouge">RenderableProvider</code> anyway you need. For example, when creating a voxel engine, you could create a <code class="language-plaintext highlighter-rouge">Renderable</code> for each chunk. Or when using an entity component system, you could use <code class="language-plaintext highlighter-rouge">RenderableProvider</code> as component.</p>

<p><code class="language-plaintext highlighter-rouge">RenderableProvider</code> only has one method:</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kt">void</span> <span class="nf">getRenderables</span> <span class="o">(</span><span class="nc">Array</span><span class="o">&lt;</span><span class="nc">Renderable</span><span class="o">&gt;</span> <span class="n">renderables</span><span class="o">,</span> <span class="nc">Pool</span><span class="o">&lt;</span><span class="nc">Renderable</span><span class="o">&gt;</span> <span class="n">pool</span><span class="o">);</span>
</code></pre></div></div>
<p>This is a very open API (e.g. it gives you access to the <code class="language-plaintext highlighter-rouge">Array</code> of all previously added <code class="language-plaintext highlighter-rouge">Renderable</code>s), but you should restrict your usage to only adding elements to the array. The pool can optionally be used to avoid allocation. You’re free to ignore it or to use it for any dynamic <code class="language-plaintext highlighter-rouge">Renderable</code> needed. Any <code class="language-plaintext highlighter-rouge">Renderable</code> you <code class="language-plaintext highlighter-rouge">obtain()</code> from it, will be automatically be free’d by the <code class="language-plaintext highlighter-rouge">ModelBatch</code>, you don’t have to take care for that.</p>

<h1 id="gather-shaders">Gather shaders</h1>
<h2 id="what-is-a-shader">What is a shader?</h2>
<p>A <a href="http://libgdx.badlogicgames.com/nightlies/docs/api/com/badlogic/gdx/graphics/g3d/Shader.html"><code class="language-plaintext highlighter-rouge">Shader</code></a>  (<a href="https://github.com/libgdx/libgdx/blob/master/gdx/src/com/badlogic/gdx/graphics/g3d/Shader.java" rel="external">code<span class="ico-ext"><i class="fas fa-external-link-alt"></i></span></a>) is an interface that abstracts the implementation of actually performing the render call. Typically its implementation uses a <a href="http://libgdx.badlogicgames.com/nightlies/docs/api/com/badlogic/gdx/graphics/glutils/ShaderProgram.html"><code class="language-plaintext highlighter-rouge">ShaderProgram</code></a> which is the GPU program (e.g. the <em>vertex shader</em> and <em>fragment shader</em>) needed to perform the render call. The <code class="language-plaintext highlighter-rouge">Shader</code> implementation also contains everything needed to use this <code class="language-plaintext highlighter-rouge">ShaderProgram</code>, like setting <em>uniform</em> values.</p>

<h2 id="shaderprovider">ShaderProvider</h2>
<p>Independent of how the actual rendering is performed, the ModelBatch needs one <code class="language-plaintext highlighter-rouge">Shader</code> per <code class="language-plaintext highlighter-rouge">Renderable</code>. For this it uses the <a href="http://libgdx.badlogicgames.com/nightlies/docs/api/com/badlogic/gdx/graphics/g3d/utils/ShaderProvider.html"><code class="language-plaintext highlighter-rouge">ShaderProvider</code></a> (<a href="https://github.com/libgdx/libgdx/blob/master/gdx/src/com/badlogic/gdx/graphics/g3d/utils/ShaderProvider.java" rel="external">code<span class="ico-ext"><i class="fas fa-external-link-alt"></i></span></a>) interface. For every <code class="language-plaintext highlighter-rouge">Renderable</code> added to the batch (even if it contains a shader), the <code class="language-plaintext highlighter-rouge">getShader</code> of the <code class="language-plaintext highlighter-rouge">ShaderProvider</code> will be called to fetch to shader to render it.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nc">Shader</span> <span class="nf">getShader</span> <span class="o">(</span><span class="nc">Renderable</span> <span class="n">renderable</span><span class="o">);</span>
</code></pre></div></div>

<p>By default the <a href="http://libgdx.badlogicgames.com/nightlies/docs/api/com/badlogic/gdx/graphics/g3d/utils/DefaultShaderProvider.html">DefaultShaderProvider</a> (<a href="https://github.com/libgdx/libgdx/blob/master/gdx/src/com/badlogic/gdx/graphics/g3d/utils/DefaultShaderProvider.java" rel="external">code<span class="ico-ext"><i class="fas fa-external-link-alt"></i></span></a>) is used, which will create a <a href="http://libgdx.badlogicgames.com/nightlies/docs/api/com/badlogic/gdx/graphics/g3d/shaders/DefaultShader.html">DefaultShader</a> whenever a previous created shader can’t be reused. You can, however, customize this by supplying your own <code class="language-plaintext highlighter-rouge">ShaderProvider</code> or by extending the <code class="language-plaintext highlighter-rouge">DefaultShaderProvider</code>.</p>

<p><code class="language-plaintext highlighter-rouge">ModelBatch</code> delegates managing <code class="language-plaintext highlighter-rouge">Shader</code>’s to the <code class="language-plaintext highlighter-rouge">ShaderProviders</code>. Because a <code class="language-plaintext highlighter-rouge">Shader</code> typically uses a <code class="language-plaintext highlighter-rouge">ShaderProgram</code>, they need to be disposed. When <code class="language-plaintext highlighter-rouge">modelBatch.dispose();</code> is called, <code class="language-plaintext highlighter-rouge">ModelBatch</code> will call the <code class="language-plaintext highlighter-rouge">dispose()</code> method the <code class="language-plaintext highlighter-rouge">ShaderProvider</code>.</p>

<p>To help managing and reusing shaders, libGDX offers the abstract <a href="http://libgdx.badlogicgames.com/nightlies/docs/api/com/badlogic/gdx/graphics/g3d/utils/BaseShaderProvider.html"><code class="language-plaintext highlighter-rouge">BaseShaderProvider</code></a> (<a href="https://github.com/libgdx/libgdx/blob/master/gdx/src/com/badlogic/gdx/graphics/g3d/utils/BaseShaderProvider.java" rel="external">code<span class="ico-ext"><i class="fas fa-external-link-alt"></i></span></a>). This class keeps track of all shaders created, reuses them if possible and disposes them when no longer needed. If you extend this class, it will call the <code class="language-plaintext highlighter-rouge">createShader(Renderable)</code> method when it hasn’t got a shader it can reuse. Whether a <code class="language-plaintext highlighter-rouge">Shader</code> can be reused, is determined by the call to <a href="http://libgdx.badlogicgames.com/nightlies/docs/api/com/badlogic/gdx/graphics/g3d/Shader.html#canRender-com.badlogic.gdx.graphics.g3d.Renderable-"><code class="language-plaintext highlighter-rouge">shader.canRender(Renderable)</code></a>.</p>

<p>A typical use-case is to extend <code class="language-plaintext highlighter-rouge">DefaultShaderProvider</code> (which extends BaseShaderProvider) and provide a custom shader when needed, while falling back to the DefaultShader when you can’t use your custom shader.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">MyShaderProvider</span> <span class="kd">extends</span> <span class="nc">DefaultShaderProvider</span> <span class="o">{</span>
	<span class="nd">@Override</span>
	<span class="kd">protected</span> <span class="nc">Shader</span> <span class="nf">createShader</span> <span class="o">(</span><span class="nc">Renderable</span> <span class="n">renderable</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">if</span> <span class="o">(</span><span class="n">renderable</span><span class="o">.</span><span class="na">material</span><span class="o">.</span><span class="na">has</span><span class="o">(</span><span class="nc">CustomColorTypes</span><span class="o">.</span><span class="na">AlbedoColor</span><span class="o">))</span>
			<span class="k">return</span> <span class="k">new</span> <span class="nf">MyShader</span><span class="o">(</span><span class="n">renderable</span><span class="o">);</span>
		<span class="k">else</span>
			<span class="k">return</span> <span class="kd">super</span><span class="o">.</span><span class="na">createShader</span><span class="o">(</span><span class="n">renderable</span><span class="o">);</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<p>Here the <a href="/wiki/material-and-environment">Material</a> is used to decide whether the custom shader should be used. This is the preferred and easiest method. However, you can use any value, including the generic <a href="http://libgdx.badlogicgames.com/nightlies/docs/api/com/badlogic/gdx/graphics/g3d/Renderable.html#userData"><code class="language-plaintext highlighter-rouge">renderable.userData</code></a> to decide which shader to use, as long as its <code class="language-plaintext highlighter-rouge">shader.canRender(renderable)</code> method returns true for the given renderable.</p>

<h2 id="default-shader">Default shader</h2>
<p>When you don’t specify a custom <code class="language-plaintext highlighter-rouge">ShaderProvider</code>, then <code class="language-plaintext highlighter-rouge">ModelBatch</code> will use the <code class="language-plaintext highlighter-rouge">DefaultShaderProvider</code>. This provider creates a new <a href="http://libgdx.badlogicgames.com/nightlies/docs/api/com/badlogic/gdx/graphics/g3d/shaders/DefaultShader.html"><code class="language-plaintext highlighter-rouge">DefaultShader</code></a> instance when needed.</p>

<p>The <code class="language-plaintext highlighter-rouge">DefaultShader</code> class provides a default implementation of most of the standard <a href="https://github.com/libgdx/libgdx/wiki/Material-and-environment" rel="external">material and environment attributes<span class="ico-ext"><i class="fas fa-external-link-alt"></i></span></a>, including lighting, normal maps, reflection cubemaps, etc. That is: it binds the attribute values to the corresponding <code class="language-plaintext highlighter-rouge">uniform</code>s. <a href="https://github.com/libgdx/libgdx/blob/1.7.0/gdx/src/com/badlogic/gdx/graphics/g3d/shaders/DefaultShader.java#L81-L120" rel="external">A list of uniform names can be found here<span class="ico-ext"><i class="fas fa-external-link-alt"></i></span></a>.</p>

<blockquote>
  <p><strong>NOTE: by default, the shader program (the glsl files) use per-vertex lighting (<a href="https://en.wikipedia.org/wiki/Gouraud_shading" rel="external">Gouraud shading<span class="ico-ext"><i class="fas fa-external-link-alt"></i></span></a>).Normal mapping, reflection etc. is not applied by default.</strong></p>
</blockquote>

<p>The behavior of this class is configurable by supplying a <a href="https://libgdx.badlogicgames.com/nightlies/docs/api/com/badlogic/gdx/graphics/g3d/shaders/DefaultShader.Config.html"><code class="language-plaintext highlighter-rouge">DefaultShader.Config</code></a> instance to the <code class="language-plaintext highlighter-rouge">DefaultShaderProvider</code>.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">DefaultShader</span><span class="o">.</span><span class="na">Config</span> <span class="n">config</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">DefaultShader</span><span class="o">.</span><span class="na">Config</span><span class="o">();</span>
<span class="n">config</span><span class="o">.</span><span class="na">numDirectionalLights</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>
<span class="n">config</span><span class="o">.</span><span class="na">numPointLights</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
<span class="n">config</span><span class="o">.</span><span class="na">numBones</span> <span class="o">=</span> <span class="mi">16</span><span class="o">;</span>
<span class="n">modelBatch</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ModelBatch</span><span class="o">(</span><span class="k">new</span> <span class="nc">DefaultShaderProvider</span><span class="o">(</span><span class="n">config</span><span class="o">));</span>
</code></pre></div></div>

<blockquote>
  <p><strong>NOTE:</strong> the default configuration is rarely the most optimal for each use-case. For example it uses 5 point lights and 2 directional lights, even if you’re only using 1 direction and 1 point light. Make sure to adjust it to your specific use-case to get the most out of it. <a href="https://github.com/libgdx/libgdx/wiki/3D-animations-and-skinning#loading-skinning" rel="external">If you’re using skinning, then the number of bones must match the number of bones the model is created with.<span class="ico-ext"><i class="fas fa-external-link-alt"></i></span></a></p>
</blockquote>

<p>The <a href="https://github.com/libgdx/libgdx/wiki/Shaders" rel="external">GPU shader<span class="ico-ext"><i class="fas fa-external-link-alt"></i></span></a> (the vertex and fragment shader) to be used is also configurable using this config. Because this shader can be used for various combinations of attributes, it typically is a so-called <em>ubershader</em>. This is shader glsl code of which parts are enabled or disabled based on the <code class="language-plaintext highlighter-rouge">Renderable</code> by using <a href="https://www.opengl.org/wiki/Core_Language_(GLSL)#Preprocessor_directives" rel="external">pre-processor macro directives<span class="ico-ext"><i class="fas fa-external-link-alt"></i></span></a>. For example:</p>

<div class="language-glsl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#ifdef blendedFlag
</span>	<span class="nb">gl_FragColor</span><span class="p">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">diffuse</span><span class="p">.</span><span class="n">a</span> <span class="o">*</span> <span class="n">v_opacity</span><span class="p">;</span>
	<span class="cp">#ifdef alphaTestFlag
</span>		<span class="k">if</span> <span class="p">(</span><span class="nb">gl_FragColor</span><span class="p">.</span><span class="n">a</span> <span class="o">&lt;=</span> <span class="n">v_alphaTest</span><span class="p">)</span>
			<span class="k">discard</span><span class="p">;</span>
	<span class="cp">#endif
#else
</span>	<span class="nb">gl_FragColor</span><span class="p">.</span><span class="n">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="p">;</span>
<span class="cp">#endif
</span></code></pre></div></div>

<p>In this snippet, the actual code used for the shader depends on whether <code class="language-plaintext highlighter-rouge">blendedFlag</code> and/or <code class="language-plaintext highlighter-rouge">alphaTestFlag</code> are defined. <a href="https://github.com/libgdx/libgdx/blob/1.7.0/gdx/src/com/badlogic/gdx/graphics/g3d/shaders/DefaultShader.java#L631-L702" rel="external">The <code class="language-plaintext highlighter-rouge">DefaultShader</code> class defines these based on the values of the <code class="language-plaintext highlighter-rouge">Renderable</code>.<span class="ico-ext"><i class="fas fa-external-link-alt"></i></span></a></p>

<p>If you don’t specify a custom ubershader, then the default ubershader will be used (see the source of the: <a href="https://github.com/libgdx/libgdx/blob/1.7.0/gdx/src/com/badlogic/gdx/graphics/g3d/shaders/default.vertex.glsl" rel="external">vertex shader<span class="ico-ext"><i class="fas fa-external-link-alt"></i></span></a> and <a href="https://github.com/libgdx/libgdx/blob/1.7.0/gdx/src/com/badlogic/gdx/graphics/g3d/shaders/default.fragment.glsl" rel="external">fragment shader<span class="ico-ext"><i class="fas fa-external-link-alt"></i></span></a>). Although this shader supports most basic attributes (like skinning, diffuse and specular per-vertex lighting etc.), it is very generic and cannot support every possible combination of attributes.</p>

<blockquote>
  <p>If you want to have per-fragment lighting, normal mapping, reflection then you can use <a href="https://gist.github.com/xoppa/9766698" rel="external">this “unofficial” shader<span class="ico-ext"><i class="fas fa-external-link-alt"></i></span></a>. But, please note that this shader adds this functionality at the cost of e.g. being restricted to a single directional light.</p>
</blockquote>

<p>If you look at the source of the default ubershader, then you’ll probably notice that it is huge and almost impossible to read, let alone maintain it. Luckily you don’t have to support every possible combination of attributes and as we’ve seen in the previous paragraph you can extend the <code class="language-plaintext highlighter-rouge">DefaultShaderProvider</code> and break it into multiple shaders to make it easier to maintain. For example:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">MyShaderProvider</span> <span class="kd">extends</span> <span class="nc">DefaultShaderProvider</span> <span class="o">{</span>
	<span class="nc">DefaultShader</span><span class="o">.</span><span class="na">Config</span> <span class="n">albedoConfig</span><span class="o">;</span>

	<span class="kd">public</span> <span class="nf">MyShaderProvider</span><span class="o">(</span><span class="nc">DefaultShader</span><span class="o">.</span><span class="na">Config</span> <span class="n">defaultConfig</span><span class="o">)</span> <span class="o">{</span>
		<span class="kd">super</span><span class="o">(</span><span class="n">defaultConfig</span><span class="o">);</span>
		<span class="n">albedoConfig</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">DefaultShader</span><span class="o">.</span><span class="na">Config</span><span class="o">();</span>
		<span class="n">albedoConfig</span><span class="o">.</span><span class="na">vertexShader</span> <span class="o">=</span> <span class="nc">Gdx</span><span class="o">.</span><span class="na">files</span><span class="o">.</span><span class="na">internal</span><span class="o">(</span><span class="s">"data/albedo.vertex.glsl"</span><span class="o">).</span><span class="na">readString</span><span class="o">();</span>
		<span class="n">albedoConfig</span><span class="o">.</span><span class="na">fragmentShader</span> <span class="o">=</span> <span class="nc">Gdx</span><span class="o">.</span><span class="na">files</span><span class="o">.</span><span class="na">internal</span><span class="o">(</span><span class="s">"data/albedo.fragment.glsl"</span><span class="o">).</span><span class="na">readString</span><span class="o">();</span>
	<span class="o">}</span>
	<span class="nd">@Override</span>
	<span class="kd">protected</span> <span class="nc">Shader</span> <span class="nf">createShader</span> <span class="o">(</span><span class="nc">Renderable</span> <span class="n">renderable</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">if</span> <span class="o">(</span><span class="n">renderable</span><span class="o">.</span><span class="na">material</span><span class="o">.</span><span class="na">has</span><span class="o">(</span><span class="nc">CustomColorTypes</span><span class="o">.</span><span class="na">AlbedoColor</span><span class="o">))</span>
			<span class="k">return</span> <span class="k">new</span> <span class="nf">DefaultShader</span><span class="o">(</span><span class="n">renderable</span><span class="o">,</span> <span class="n">albedoConfig</span><span class="o">);</span>
		<span class="k">else</span>
			<span class="k">return</span> <span class="kd">super</span><span class="o">.</span><span class="na">createShader</span><span class="o">(</span><span class="n">renderable</span><span class="o">);</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h1 id="sorting-render-calls">Sorting render calls</h1>
<p>If render calls would be executed in a random order, then it would cause strange and less performing result. For example, if a transparent object would be rendered prior to an object that’s behind it then you won’t see the object behind it. This is because the depth buffer will prevent the object further away from being rendered. Sorting the render calls helps to solve this.</p>

<p>By default <code class="language-plaintext highlighter-rouge">ModelBatch</code> will use the <a href="http://libgdx.badlogicgames.com/nightlies/docs/api/com/badlogic/gdx/graphics/g3d/utils/DefaultRenderableSorter.html">DefaultRenderableSorter</a> (<a href="https://github.com/libgdx/libgdx/blob/master/gdx/src/com/badlogic/gdx/graphics/g3d/utils/DefaultRenderableSorter.java" rel="external">code<span class="ico-ext"><i class="fas fa-external-link-alt"></i></span></a>) to sort the render calls. This implementation will cause that opaque objects are rendered first from front to back, after which transparent objects are rendered from back to front. To decide whether an object is transparent or not, the default implementation checks the <a href="https://github.com/libgdx/libgdx/wiki/Material-and-environment#blendingattribute" rel="external">BlendingAttribute#blended<span class="ico-ext"><i class="fas fa-external-link-alt"></i></span></a> value.</p>

<p>Customizing sorting can help increase performance. For example, sorting based on shader, mesh or used textures might help decreasing shader, mesh or texture switches. These kind of optimizations are very application specific. You can customize sorting by specifying your own <a href="http://libgdx.badlogicgames.com/nightlies/docs/api/com/badlogic/gdx/graphics/g3d/utils/RenderableSorter.html"><code class="language-plaintext highlighter-rouge">RenderableSorter</code></a> (<a href="https://github.com/libgdx/libgdx/blob/master/gdx/src/com/badlogic/gdx/graphics/g3d/utils/RenderableSorter.java" rel="external">code<span class="ico-ext"><i class="fas fa-external-link-alt"></i></span></a>) implementation while constructing the <code class="language-plaintext highlighter-rouge">ModelBatch</code>. This interface contains only one method:</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kt">void</span> <span class="nf">sort</span> <span class="o">(</span><span class="nc">Camera</span> <span class="n">camera</span><span class="o">,</span> <span class="nc">Array</span><span class="o">&lt;</span><span class="nc">Renderable</span><span class="o">&gt;</span> <span class="n">renderables</span><span class="o">);</span>
</code></pre></div></div>
<p>This method provides all information the <code class="language-plaintext highlighter-rouge">ModelBatch</code> has just before the actually rendering. It is also a very open API, you are allowed to modify the array as needed. This makes it possible to perform any last-minute actions (that might not be even related to sorting, like frustum culling) in this interface. The order of the <code class="language-plaintext highlighter-rouge">renderables</code> after this method completes, will be the order in which the render calls will be actually executed.</p>

<h1 id="managing-the-render-context">Managing the render context</h1>
<p><code class="language-plaintext highlighter-rouge">ModelBatch</code> allows you to avoid redundant OpenGL calls, including texture binds, across multiple <code class="language-plaintext highlighter-rouge">Shader</code> implementations. For example, when a <code class="language-plaintext highlighter-rouge">Shader</code> requires backface culling and a previous shader enabled backface culling, then the redundant call to <code class="language-plaintext highlighter-rouge">glEnable</code> and <code class="language-plaintext highlighter-rouge">glCullFace</code> can be avoided.</p>

<h2 id="rendercontext">RenderContext</h2>
<p>The <a href="http://libgdx.badlogicgames.com/nightlies/docs/api/com/badlogic/gdx/graphics/g3d/utils/RenderContext.html"><code class="language-plaintext highlighter-rouge">RenderContext</code></a> class tries to avoid these unnecessary calls. This class acts as a thin layer on top of OpenGL ES that keeps track of previous calls and therefore avoids making redundant calls. Only a small subset of the GL calls is implemented, but you can extend it to add additional calls. When not specified as argument in the constructor, <code class="language-plaintext highlighter-rouge">ModelBatch</code> will create and manage a <code class="language-plaintext highlighter-rouge">RenderContext</code> for you.</p>

<p><strong>Caution:</strong> Obviously this will only work if all <code class="language-plaintext highlighter-rouge">Shader</code> implementations use the <code class="language-plaintext highlighter-rouge">RenderContext</code> instead of directly making GL calls. You should always use the <code class="language-plaintext highlighter-rouge">RenderContext</code> if possible, instead of directly calling the corresponding GL call.</p>

<p>For example: When depth testing is enabled using the RenderContext, then it will enable depth testing for you. Now when you use e.g. SpriteBatch then that disables depth testing but doesn’t update the RenderContext. This will lead to unexpected results. To avoid this, by default (when you don’t specify a RenderContext yourself) ModelBatch will <em>reset</em> the RenderContext on both the <code class="language-plaintext highlighter-rouge">begin()</code> and <code class="language-plaintext highlighter-rouge">end()</code> methods, by calling the same named methods on the RenderContext. This is to make sure that context switches outside the ModelBatch don’t interfere with the rendering.</p>

<p>However, when you specify your own <code class="language-plaintext highlighter-rouge">RenderContext</code> (which doesn’t have to be a custom implementation of it) then you’re responsible for calling the <code class="language-plaintext highlighter-rouge">context.begin()</code> and <code class="language-plaintext highlighter-rouge">context.end()</code> methods. This allows you use the same context for multiple ModelBatch instances or even avoid having to reset the context all together.</p>

<blockquote>
  <p>If you specify a RenderContext on construction then you own that RenderContext and are expected to reset (call its begin() and end() methods) when needed. You can call the <a href="http://libgdx.badlogicgames.com/nightlies/docs/api/com/badlogic/gdx/graphics/g3d/ModelBatch.html#ownsRenderContext--">modelBatch.ownsRenderContext</a> method to check whether the ModelBatch owns and manages the RenderContext.</p>
</blockquote>

<h2 id="texturebinder">TextureBinder</h2>
<p>To keep track of the textures currently being bound, RenderContext contains a <a href="http://libgdx.badlogicgames.com/nightlies/docs/api/com/badlogic/gdx/graphics/g3d/utils/RenderContext.html#textureBinder">textureBinder</a> member. <a href="http://libgdx.badlogicgames.com/nightlies/docs/api/com/badlogic/gdx/graphics/g3d/utils/TextureBinder.html"><code class="language-plaintext highlighter-rouge">TextureBinder</code></a> (<a href="https://github.com/libgdx/libgdx/blob/master/gdx/src/com/badlogic/gdx/graphics/g3d/utils/TextureBinder.java" rel="external">code<span class="ico-ext"><i class="fas fa-external-link-alt"></i></span></a>) is an interface used to keep track of texture binds, as well as texture context (e.g. the minification/magnification filters). By default the <a href="http://libgdx.badlogicgames.com/nightlies/docs/api/com/badlogic/gdx/graphics/g3d/utils/DefaultTextureBinder.html"><code class="language-plaintext highlighter-rouge">DefaultTextureBinder</code></a> (<a href="https://github.com/libgdx/libgdx/blob/master/gdx/src/com/badlogic/gdx/graphics/g3d/utils/DefaultTextureBinder.java" rel="external">code<span class="ico-ext"><i class="fas fa-external-link-alt"></i></span></a>) is used. Although you can specify your own implementation, this is rarely required.</p>

<p>The DefaultTextureBinder uses every available texture unit (within the specified range) to avoid unneeded texture binds. A typical modern mobile GPU offers around 16 or 32 texture units to which textures can be bound. OpenGL ES limits the number of units to 32. You can specify the range to use when constructing the DefaultTextureBinder, using the <code class="language-plaintext highlighter-rouge">offset</code> and <code class="language-plaintext highlighter-rouge">count</code> arguments. If you don’t specify an offset, then 0 is assumed. If you don’t specify a count then all available remaining units will be used. ModelBatch will, by default, exclude texture unit 0 from the range, because this is often used for GUI. So by default, texture unit <code class="language-plaintext highlighter-rouge">1</code> to <code class="language-plaintext highlighter-rouge">31</code> will be used, unless the GPU supports less texture units.</p>

<p><code class="language-plaintext highlighter-rouge">DefaultTextureBinder</code> supports two methods:</p>
<ul>
  <li>
<strong>ROUNDROBIN:</strong> When a texture is already bound, then it is reused. Otherwise the first texture is bound to the first available unit, the next texture is bound to the next available unit, and so on. When all available units are used, then binding restarts at the first available unit, overwriting the previous bound texture.</li>
  <li>
<strong>WEIGHTED:</strong> Weights the textures by counting the number of times a texture is used or not. Often reused textures are less likely to be overwritten, while less reused textures are more likely to be overwritten.</li>
</ul>

<p>By default ModelBatch will use the <em>WEIGHTED</em> method.</p>

<p>You can bind a texture using <code class="language-plaintext highlighter-rouge">TextureBinder</code> by calling the <code class="language-plaintext highlighter-rouge">bind(...)</code> method. This method will return the unit the texture is bound to. So, practically, you can bind a texture in your <code class="language-plaintext highlighter-rouge">Shader</code> to an <em>uniform</em> like this:</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">program</span><span class="o">.</span><span class="na">setUniformi</span><span class="o">(</span><span class="n">uniformLocation</span><span class="o">,</span> <span class="n">context</span><span class="o">.</span><span class="na">textureBinder</span><span class="o">.</span><span class="na">bind</span><span class="o">(</span><span class="n">texture</span><span class="o">));</span>
</code></pre></div></div>

<h3 id="texturedescriptor">TextureDescriptor</h3>
<p>The api often uses a <code class="language-plaintext highlighter-rouge">TextureDescriptor</code> when specifying a texture. This is because you might want to use a texture but do require specific context properties. These properties currently include the minification and magnification filters, as well as the horizontal wrapping and vertical wrapping. Therefor the TextureDescriptor is also used by e.g. the <a href="/wiki/material-and-environment#textureattribute">TextureAttribute</a> and <a href="/wiki/material-and-environment#cubemapattribute">CubemapAttribute</a>. For convenience, TextureBinder allows you to directly specify a TextureDescriptor:</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">program</span><span class="o">.</span><span class="na">setUniformi</span><span class="o">(</span><span class="n">uniformLocation</span><span class="o">,</span> <span class="n">context</span><span class="o">.</span><span class="na">textureBinder</span><span class="o">.</span><span class="na">bind</span><span class="o">(</span>
    <span class="o">(</span><span class="nc">TextureAttribute</span><span class="o">)(</span><span class="n">renderable</span><span class="o">.</span><span class="na">material</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="nc">TextureAttribute</span><span class="o">.</span><span class="na">Diffuse</span><span class="o">)))</span>
        <span class="o">.</span><span class="na">textureDescription</span><span class="o">));</span>
</code></pre></div></div>


        <div style="border-color: #d0d7de;border-style: solid;border-width: 1px;border-radius: 6px;box-shadow: 0 1px 0 rgba(27,31,36,0.04) !important;background-color: #f6f8fa !important;padding: 8px 16px;margin-bottom: 20px;margin-top: 15px;">
          <p style="font-size: 13px;margin-bottom: 0px !important;">
            <b>© 2021 libGDX</b> • This wiki is a community effort. If you find information out of date or want to add some more in-depth explanations, you are very welcome to do the necessary changes. Before contributing, please take a look at our <a href="/wiki/wiki-style-guide">Wiki Style Guide</a>.
            <br>
            <br>
            <b>If you need additional help, check out our community on <a href="https://libgdx.com/community/discord/" rel="external">Discord<span class="ico-ext"><i class="fas fa-external-link-alt"></i></span></a>!</b>
          </p>
        </div>
      </section>
    </div>

  </article>
</div>


    </div>

    
  <script src="/pages/crykn/assets/js/main.min.js"></script>










  </body>
</html>
